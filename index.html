<!DOCTYPE html>
<html>
<body>

<h1>The DCP API</h1>
<p>Click the button to use your portal account to generate your DCP API keys!</p>

<button type="button" id="someButton">Click Me!</button> 

</body>

<script src="http://scheduler.rhea.office.distributive.network/dcp-client/dcp-client.js"></script>
<script>

//window.open(dcpConfig.oAuth.location.resolve('/reflector'), 'DCP Login', 'popup=yes,left=200,top=200,width=400,height=360')

async function main() {
  const loginBtn = document.getElementById('someButton');
  // make button open a popup with the configured oauth server's reflector page
  loginBtn.onclick = () => window.open(dcpConfig.oAuth.location.resolve('/reflector/'), 'DCP Login', 'popup=yes,left=200,top=200,width=400,height=360')

  let loginks = 'none';

  // wait for a message back from the popup with the bank account keystore
  await new Promise((resolve) => {
    window.addEventListener('message', (event) => {
      // make sure it is coming from the reflector window
      if (dcpConfig.oAuth.location.sameOrigin(event.origin)) {
        loginks = event.data;
        resolve();
      } else {
        return;
      }
    });
  });

  console.log('loginks: ');
  console.log(loginks);
}

main();

</script>

</html> 



